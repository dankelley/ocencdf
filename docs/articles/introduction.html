<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>1. Introduction to ocencdf • ocencdf</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="1. Introduction to ocencdf">
<meta property="og:description" content="ocencdf">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ocencdf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">1. Introduction to ocencdf</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>1. Introduction to ocencdf</h1>
                        <h4 data-toc-skip class="author">Dan Kelley (<a href="https://orcid.org/0000-0001-7808-5911" class="external-link uri">https://orcid.org/0000-0001-7808-5911</a>)</h4>
            
            <h4 data-toc-skip class="date">2023-06-06</h4>
      
      
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<!--
Building this vignette.

1. Edit vignettes/oce.Rmd in a plain-text editor.

2. In a unix shell at the level above ocencdf, type the following:

       R CMD build --compact-vignettes="qpdf" ocencdf
       R CMD install ocencdf_0.0-1.tar.gz

   where the version number may need adjustment in the second command.

3. To see the results, type the following in an R console:

      browseVignettes("ocencdf")
-->
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>The package provides a way to store approximate forms of oce objects
as Netcdf files. Since Netcdf is handled by many computing languages, it
is a good intermediate format in multi-language processing, as well as a
good choice for data archiving.</p>
</div>
<div class="section level2">
<h2 id="limitations-of-netcdf-format">Limitations of Netcdf format<a class="anchor" aria-label="anchor" href="#limitations-of-netcdf-format"></a>
</h2>
<p>Unfortunately, direct transferral of R information to Netcdf is not
possible. This is because Netcdf is an array-oriented format that is not
designed to hold tree-oriented data such as R lists (which are used
throughout oce). It is possible to flatten simple lists, but the process
gets complicated for nested lists, which are common in oce. This is not
the only problem with Netcdf. It also lacks basic elements such as
user-defined classes and variable-length character strings. Related to
this second point is the fact that Netcdf tolerates only a single
unlimited dimension.</p>
<p>This package address these and other Netcdf limitations by focussing
effort only on certain important oce classes, and only certain elements
within those classes. The initial focus is on ctd data, mainly because
they are of greatest importance in everyday work.</p>
</div>
<div class="section level2">
<h2 id="how-the-package-works">How the package works<a class="anchor" aria-label="anchor" href="#how-the-package-works"></a>
</h2>
<div class="section level3">
<h3 id="focus-elements">Focus elements<a class="anchor" aria-label="anchor" href="#focus-elements"></a>
</h3>
<p>The design goal is to save the following elements</p>
<ol style="list-style-type: decimal">
<li>Entries in the <code>data</code> slot (e.g. temperature, salinity,
etc.)</li>
<li>Entries in the <code>flags</code> entry of the <code>metadata</code>
slot, as entries with names ending in <code>_QC</code>.</li>
<li>An approximate form of units, as strings.</li>
<li>The <code>header</code> item in the <code>metadata</code> slot.</li>
<li>A few other entries from the <code>metadata</code> slot,
e.g. <code>longitude</code> and <code>latitude</code>.</li>
</ol>
<p>Note that other <code>metadata</code> may be added as needed or
requested, but that there is no intention of trying to copy everything
over, mainly because of the awkardness of saving variable-length
character strings and lists in Netcdf.</p>
<p>Once, or if, significant progress is made on ctd data, the next
object type to examine will likely be adcp data.</p>
</div>
<div class="section level3">
<h3 id="renaming-elements">Renaming elements<a class="anchor" aria-label="anchor" href="#renaming-elements"></a>
</h3>
<p>Oce uses a restricted set of names for certain variables. For
example, in ctd objects, temperature is called <code>temperature</code>,
and if the ctd had two temperature sensors, there would be an additional
entry called <code>temperature2</code>. These are not typically the
names used in raw data files, however. More commonly, temperature might
be named <code>TEMP</code>, for example. In recognition of this, ocencdf
provides a way to rename oce objects using other systems of names. The
mapping between oce name and other name is controlled by YAML (yet
another markup language) files, which are called varTables in this
package. Tables are provided for the Argo system and for the World
Hydographic Program system. These are available as <code>"argo"</code>
and <code>"whp"</code>, respectively. They are stored in the
<code>inst/extdata</code> directory of the package source tree. Users
seeking to define new naming systems must copy the formats of those
files.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-with-ctd-data">Example with CTD data<a class="anchor" aria-label="anchor" href="#example-with-ctd-data"></a>
</h2>
<p>The first step is to create an oce object, e.g. station 100 of the
built-in <code>section</code> dataset. Note the variable names, units,
and flag values in the summary.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ocencdf</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: oce</span></span>
<span><span class="co">#&gt; Loading required package: gsw</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/" class="external-link">oce</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">section</span><span class="op">)</span></span>
<span><span class="va">stn</span> <span class="op">&lt;-</span> <span class="va">section</span><span class="op">[[</span><span class="st">"station"</span>, <span class="fl">100</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">stn</span><span class="op">)</span></span>
<span><span class="co">#&gt; CTD Summary</span></span>
<span><span class="co">#&gt; -----------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * Start time:          1993-10-22 03:10:00</span></span>
<span><span class="co">#&gt; * Station:             109</span></span>
<span><span class="co">#&gt; * Mean Location:       36.323N 69.376W</span></span>
<span><span class="co">#&gt; * Water depth:         4499</span></span>
<span><span class="co">#&gt; * Data Overview</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                 Min.   Mean   Max. Dim. NAs OriginalName</span></span>
<span><span class="co">#&gt;     pressure [dbar]             11.4 2182.5 4398.3   24   0       CTDPRS</span></span>
<span><span class="co">#&gt;     temperature [°C, IPTS-68] 2.2233 7.3839 23.554   24   0       CTDTMP</span></span>
<span><span class="co">#&gt;     salinity [PSS-78]         34.883 35.315 36.692   24   0       CTDSAL</span></span>
<span><span class="co">#&gt;     salinityBottle [PSS-78]   34.889 35.315 36.702   24   0       SALNTY</span></span>
<span><span class="co">#&gt;     oxygen [μmol/kg]           144.9 246.91  282.1   24   0       OXYGEN</span></span>
<span><span class="co">#&gt;     silicate [μmol/kg]          1.71 16.852  36.52   24   0       SILCAT</span></span>
<span><span class="co">#&gt;     nitrite [μmol/kg]              0  0.022   0.08   24  19       NITRIT</span></span>
<span><span class="co">#&gt;     NO2+NO3 [μmol/kg]              0 14.619  23.73   24   0      NO2+NO3</span></span>
<span><span class="co">#&gt;     phosphate [μmol/kg]            0 0.8925   1.39   24   0       PHSPHT</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * Data-quality Flag Scheme</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     name    "WHP bottle"</span></span>
<span><span class="co">#&gt;     mapping list(no_information=1, no_problems_noted=2, leaking=3, did_not_trip=4, not_reported=5, discrepency=6, unknown_problem=7, did_not_trip=8, no_sample=9)</span></span>
<span><span class="co">#&gt;     default c(1, 3, 4, 5, 6, 7, 8, 9)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * Data-quality Flags</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     salinity:       "2" 22, "3" 2</span></span>
<span><span class="co">#&gt;     salinityBottle: "2" 24</span></span>
<span><span class="co">#&gt;     oxygen:         "2" 24</span></span>
<span><span class="co">#&gt;     silicate:       "2" 24</span></span>
<span><span class="co">#&gt;     nitrite:        "2" 5, "5" 19</span></span>
<span><span class="co">#&gt;     NO2+NO3:        "2" 24</span></span>
<span><span class="co">#&gt;     phosphate:      "2" 24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * Processing Log</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     - 2022-01-03 13:21:08 UTC: `create 'ctd' object`</span></span>
<span><span class="co">#&gt;     - 2022-01-03 13:21:08 UTC: `initializeFlagScheme(object, name="WHP bottle", mapping=list(no_information=1,no_problems_noted=2,leaking=3,did_not_trip=4,not_reported=5,discrepency=6,unknown_problem=7,did_not_trip=8,no_sample=9)), default=c(1,3,4,5,6,7,8,9))`</span></span></code></pre></div>
<p>Now, save as a netcdf file, using (say) the Argo convention for
variable names.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/oce2ncdf.html">oce2ncdf</a></span><span class="op">(</span><span class="va">stn</span>, varTable<span class="op">=</span><span class="st">"argo"</span>, ncfile<span class="op">=</span><span class="st">"stn.nc"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Converting temperature from IPTS-68 scale to ITS-90 scale.</span></span></code></pre></div>
<p>The <code>stn.nc</code> file may be examined in various ways, but we
leave that up to the reader. Note that the column names are
e.g. <code>TEMP</code> in the Netcdf file, because the varTable named
<code>"argo"</code> establishes that nickname.</p>
<p>In R, we can read <code>stn.nc</code> and get a summary with the
following.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ncdf2oce.html">ncdf2oce</a></span><span class="op">(</span><span class="st">"stn.nc"</span>, varTable<span class="op">=</span><span class="st">"argo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt; * Data Overview</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            Min.    Mean    Max. Dim. NAs</span></span>
<span><span class="co">#&gt;     pressure [dbar]        11.4  2182.5  4398.3   24   0</span></span>
<span><span class="co">#&gt;     temperature [°C]     2.2228  7.3822  23.548   24   0</span></span>
<span><span class="co">#&gt;     salinity             34.883  35.315  36.692   24   0</span></span>
<span><span class="co">#&gt;     salinityBottle       34.889  35.315  36.702   24   0</span></span>
<span><span class="co">#&gt;     oxygen [μmol/kg]      144.9  246.91   282.1   24   0</span></span>
<span><span class="co">#&gt;     silicate [μmol/kg]     1.71  16.853   36.52   24   0</span></span>
<span><span class="co">#&gt;     nitrite [μmol/kg]         0   0.022    0.08   24  19</span></span>
<span><span class="co">#&gt;     NO2+NO3 [μmol/kg]         0  14.619   23.73   24   0</span></span>
<span><span class="co">#&gt;     phosphate [μmol/kg]       0  0.8925    1.39   24   0</span></span>
<span><span class="co">#&gt;     salinity_QC               2  2.0833       3   24   0</span></span>
<span><span class="co">#&gt;     salinityBottle_QC         2       2       2   24   0</span></span>
<span><span class="co">#&gt;     oxygen_QC                 2       2       2   24   0</span></span>
<span><span class="co">#&gt;     silicate_QC               2       2       2   24   0</span></span>
<span><span class="co">#&gt;     nitrite_QC                2   4.375       5   24   0</span></span>
<span><span class="co">#&gt;     NO2+NO3_QC                2       2       2   24   0</span></span>
<span><span class="co">#&gt;     phosphate_QC              2       2       2   24   0</span></span>
<span><span class="co">#&gt;     longitude [°E]      -69.376 -69.376 -69.376    1   0</span></span>
<span><span class="co">#&gt;     latitude [°N]        36.323  36.323  36.323    1   0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * Processing Log</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     - 2023-06-06 13:35:50 UTC: `Create oce object`</span></span></code></pre></div>
<p>Note that the variable names have been converted from Netcdf names
(e.g. <code>"TEMP"</code>) to oce names
(e.g. <code>"temperature"</code>). Units have also been decoded (again,
according to the <code>"argo"</code> varTable). However, notice that the
flags are being displayed as though they were data columns
(e.g. <code>temperature_QC</code>). This is because
<code><a href="../reference/ncdf2oce.html">ncdf2oce()</a></code> does not try to translate these into flags. To
do that, use <code><a href="https://dankelley.github.io/oce/reference/as.ctd.html" class="external-link">as.ctd()</a></code>, as follows.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dankelley.github.io/oce/reference/as.ctd.html" class="external-link">as.ctd</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span>
<span><span class="co">#&gt; CTD Summary</span></span>
<span><span class="co">#&gt; -----------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * Start time:          1993-10-22 03:09:52</span></span>
<span><span class="co">#&gt; * Station:             109</span></span>
<span><span class="co">#&gt; * Data Overview</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           Min.   Mean   Max. Dim. NAs</span></span>
<span><span class="co">#&gt;     pressure [dbar]       11.4 2182.5 4398.3   24   0</span></span>
<span><span class="co">#&gt;     temperature [°C]    2.2228 7.3822 23.548   24   0</span></span>
<span><span class="co">#&gt;     salinity            34.883 35.315 36.692   24   0</span></span>
<span><span class="co">#&gt;     salinityBottle      34.889 35.315 36.702   24   0</span></span>
<span><span class="co">#&gt;     oxygen [μmol/kg]     144.9 246.91  282.1   24   0</span></span>
<span><span class="co">#&gt;     silicate [μmol/kg]    1.71 16.853  36.52   24   0</span></span>
<span><span class="co">#&gt;     nitrite [μmol/kg]        0  0.022   0.08   24  19</span></span>
<span><span class="co">#&gt;     NO2+NO3 [μmol/kg]        0 14.619  23.73   24   0</span></span>
<span><span class="co">#&gt;     phosphate [μmol/kg]      0 0.8925   1.39   24   0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * Data-quality Flags</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     salinity:       "2" 22, "3" 2</span></span>
<span><span class="co">#&gt;     salinityBottle: "2" 24</span></span>
<span><span class="co">#&gt;     oxygen:         "2" 24</span></span>
<span><span class="co">#&gt;     silicate:       "2" 24</span></span>
<span><span class="co">#&gt;     nitrite:        "2" 5, "5" 19</span></span>
<span><span class="co">#&gt;     NO2+NO3:        "2" 24</span></span>
<span><span class="co">#&gt;     phosphate:      "2" 24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * Processing Log</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     - 2023-06-06 13:35:51 UTC: `create 'ctd' object`</span></span>
<span><span class="co">#&gt;     - 2023-06-06 13:35:51 UTC: `as.ctd(salinity = A)`</span></span></code></pre></div>
<p><strong>Exercise:</strong> Try using <code><a href="../reference/ncdf2ctd.html">ncdf2ctd()</a></code> instead
of the two-step procedure used for <code>A</code> and <code>B</code>. Do
you get the same results?</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dan Kelley.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
